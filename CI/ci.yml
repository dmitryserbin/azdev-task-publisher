trigger: none

pr:
  branches:
    include:
    - master
  autoCancel: true

pool:
  vmImage: windows-latest

steps:
- task: PowerShell@2
  displayName: Run Tests
  inputs:
    filePath: CI/Scripts/Validate.ps1
    arguments: -Path PublisherV1/Tests

- task: PublishTestResults@2
  displayName: Publish Test Results
  inputs:
    testResultsFormat: NUnit
    testResultsFiles: "**/TestResults.xml"
  condition: succeededOrFailed()

- task: PowerShell@2
  displayName: Package Extension
  inputs:
    filePath: CI/Scripts/Package.ps1
    arguments: -Path $(Build.SourcesDirectory) -Output $(Build.StagingDirectory)
